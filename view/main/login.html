<!DOCTYPE html>
<html lang="en" style="background: #f8f8f8">
<head>
    <script>if(window.screen.width < 420){
        window.location.href = "/view/main/Login_m";
    }</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="/public/images/favicon.ico" rel="shortcut icon">
    <link rel="stylesheet" href="/public/css/choulouderen.css">
    <title>登录</title>
</head>
<body>
<span id="header"></span>
<section class="sgin_box">
    <div class="sgin">
        <h1>登录</h1>
        <h1 class="message"  id="errMessage"></h1>
        <ul class="put no_style">
            <li>
                <p>账号</p>
                <input type="text" id="username" placeholder="注册邮箱">
                <b><em></em></b>
            </li>
            <li>
                <p>密码</p>
                <input type="password" id="passwd" placeholder="密码">
                <b><em></em></b>
            </li>
        </ul>
        <p class="tishi">请用注册邮箱登录</p>
        <button class="btn" onclick="login()">登录</button>
        <div class="Retrieve"><a href="/view/main/retrieve">找回密码</a></div>
    </div> 
</section>
<script src="/public/js/common.js"></script>    
<script>
    window.onload = function(){
        
        /* 显示头部和脚 */
        get_head_foot();

        var errMessage = document.getElementById("errMessage");
        /* 用户登录 */
        login = function(){
            var username = document.getElementById("username").value;
            var passwd = document.getElementById("passwd").value;
            var data = {
                username:username,
                passwd:passwd,
            }
            $.ajax({
                url:"/api/post/sign_in",
                data:data,
                success:function(res){
                    if(res.code == 3){
                        errMessage.innerHTML = res.message + ",1秒中后将跳转到首页";
                        setTimeout(() => {
                            window.location.href = "/";
                        }, 1000);
                    }else{
                        errMessage.innerHTML = res.message;
                    }
                }
            });
        }
    }
</script>
</body>
</html>